{% extends "layout.html" %}

{% block content %}
    <h2>Help Me Learn About {{ animal | title }}</h2>
    <p>What's a good question to distinguish a <strong>{{ animal }}</strong> from other {{ domain }}?</p>

    <form action="{{ url_for('submit_question') }}" method="POST" class="learn-form" style="max-width: 450px; margin: 0 auto;">
        
        <input type="hidden" name="animal" value="{{ animal }}">
        <input type="hidden" name="domain_name" value="{{ domain }}">

        <label for="feature_name" style="text-align: left; width: 100%; font-weight: 500; margin-bottom: -5px;">Feature Name</label>
        <input type="text" id="feature_name" name="feature_name" placeholder="e.g., 'has_stripes' or 'is_mammal'" required class="input-field" title="A short name for the code, no spaces.">
        
        <label for="question_text" style="text-align: left; width: 100%; font-weight: 500; margin-bottom: -5px;">Question Text</label>
        <input type="text" id="question_text" name="question_text" placeholder="e.g., 'Does it have stripes?'" required class="input-field">

        <div style="margin-top: 25px; margin-bottom: 15px; background: #f9f9f9; padding: 12px; border-radius: 4px; border: 1px solid #eee;">
            <p style="text-align: left; margin: 0 0 8px 0; font-size: 0.9rem; font-weight: 500; color: #333;">
                Now, please answer your new question:
            </p>
            <blockquote id="question-display" style="text-align: left; margin: 0 0 0 10px; padding-left: 10px; font-size: 1.1rem; font-weight: 600; color: #000; border-left: 3px solid #ccc; min-height: 1.2em;">
                "..."
            </blockquote>
        </div>

        <label for="answer_for_{{ animal }}" style="text-align: left; width: 100%; font-weight: 500; margin-bottom: -5px; margin-top: 10px;">For a <strong>{{ animal | title }}</strong>, the answer is... (Required)</label>
        <select name="answer_for_{{ animal }}" id="answer_for_{{ animal }}" required class="input-field">
            <option value="" disabled selected>Select an answer...</option>
            <option value="yes">Yes / Definitely</option>
            <option value="probably">Probably</option>
            <option value="sometimes">Sometimes / Maybe</option>
            <option value="rarely">Rarely</option>
            <option value="no">No / Not at all</option>
        </select>
        
        {% if other_animals %}
            <hr style="width: 100%;">
            <h3 style="font-size: 1.2rem; margin-top: 10px;">Answer for other {{ domain }}? (Optional)</h3>
            <p style="font-size: 0.9rem; margin-bottom: 20px;">This helps me learn much faster!</p>

            {% for other_animal in other_animals %}
            <div class="animal-answer-row">
                <label for="answer_for_{{ other_animal }}">{{ other_animal | title }}</label>
                <select name="answer_for_{{ other_animal }}" id="answer_for_{{ other_animal }}">
                    <option value="idk" selected>I Don't Know</option>
                    <option value="yes">Yes</option>
                    <option value="probably">Probably</option>
                    <option value="sometimes">Sometimes</option>
                    <option value="rarely">Rarely</option>
                    <option value="no">No</option>
                </select>
            </div>
            {% endfor %}
        {% endif %}

        <button type="submit" class="btn btn-primary" style="margin-top: 20px;">Submit Feature</button>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const questionInput = document.getElementById('question_text');
            const questionDisplay = document.getElementById('question-display');

            if (questionInput && questionDisplay) {
                // Function to update the display
                function updateDisplay() {
                    if (questionInput.value) {
                        questionDisplay.textContent = '\"' + questionInput.value + '\"';
                    } else {
                        questionDisplay.textContent = '"..."';
                    }
                }

                // Run it on input
                questionInput.addEventListener('input', updateDisplay);

                // Run it once on load in case of browser auto-fill
                updateDisplay();
            }
        });
    </script>
{% endblock %}