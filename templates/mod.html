{% extends "layout.html" %}
<!-- This piece of code is for the moderation page and it lets the users who have a login be able to access the moderators page so that they can make changes to the items and questions-->
{% block content %}
    <h2 style="margin-bottom: 5px;">Moderator Panel</h2>
    <p>Review suggested features and items from users.</p>

    <!-- Container for the two moderation tables -->
    <div style="width: 100%; max-width: 900px; margin: 20px auto; text-align: left; display: flex; flex-direction: column; gap: 40px;">

        <!-- Section for Suggested Features -->
        <div>
            <h3 style="font-size: 1.5rem; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                Suggested Features ({{ features | length }})
            </h3>
            
            {% if features %}
                <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                    <thead style="background-color: #f9f9f9;">
                        <tr>
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">Feature Name</th>
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">Question Text</th>
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for feature in features %}
                        <tr>
                            <td style="padding: 10px; border: 1px solid #eee;">
                                <code>{{ feature.feature_name }}</code>
                            </td>
                            <td style="padding: 10px; border: 1px solid #eee;">
                                {{ feature.question_text }}
                            </td>
                            <td style="padding: 10px; border: 1px solid #eee; text-align: center; white-space: nowrap;">
                                <a href="{{ url_for('moderator.mod_approve_feature', feature_id=feature.id) }}" 
                                   style="background: #e8f5e9; color: #1b5e20; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.9rem; font-weight: 500;">
                                    Approve
                                </a>
                                <a href="{{ url_for('moderator.mod_reject_feature', feature_id=feature.id) }}"
                                   style="background: #fde8e8; color: #b71c1c; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.9rem; font-weight: 500; margin-left: 5px;">
                                    Reject
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p style="text-align: center; padding: 30px; background: #fcfcfc; border: 1px solid #f0f0f0; border-radius: 10px; margin-top: 20px;">
                    No suggested features to review. All caught up!
                </p>
            {% endif %}
        </div>

        <!-- NEW Section for Suggested Items -->
        <div>
            <h3 style="font-size: 1.5rem; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                Suggested Items ({{ items | length }})
            </h3>
            
            {% if items %}
                <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                    <thead style="background-color: #f9f9f9;">
                        <tr>
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">Item Name</th>
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">Domain</th>
                            <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in items %}
                        <tr>
                            <td style="padding: 10px; border: 1px solid #eee; font-weight: 500;">
                                {{ item.item_name | title }}
                            </td>
                            <td style="padding: 10px; border: 1px solid #eee;">
                                <!-- We joined to get the domain name -->
                                {{ item.domains.domain_name | title if item.domains else 'Unknown' }}
                            </td>
                            <td style="padding: 10px; border: 1px solid #eee; text-align: center; white-space: nowrap;">
                                <a href="{{ url_for('moderator.mod_approve_item', item_id=item.id) }}" 
                                   style="background: #e8f5e9; color: #1b5e20; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.9rem; font-weight: 500;">
                                    Approve
                                </a>
                                <a href="{{ url_for('moderator.mod_reject_item', item_id=item.id) }}"
                                   style="background: #fde8e8; color: #b71c1c; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.9rem; font-weight: 500; margin-left: 5px;">
                                    Reject
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p style="text-align: center; padding: 30px; background: #fcfcfc; border: 1px solid #f0f0f0; border-radius: 10px; margin-top: 20px;">
                    No suggested items to review. All caught up!
                </p>
            {% endif %}
        </div>

    </div>

{% endblock %}
